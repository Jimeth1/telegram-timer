<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Work Timer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
            background: #0f172a;
            color: #ffffff;
        }

        h1 {
            text-align: center;
            margin-bottom: 24px;
        }

        .block {
            background: #1e293b;
            border-radius: 14px;
            padding: 16px;
            margin-bottom: 16px;
            text-align: center;
        }

        .label {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 6px;
        }

        .value {
            font-size: 28px;
            margin: 8px 0;
        }

        .buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        button {
            font-size: 18px;
            padding: 8px 14px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
        }

        .plus {
            background: #22c55e;
            color: #000;
        }

        .minus {
            background: #ef4444;
            color: #000;
        }

        .start {
            width: 100%;
            font-size: 20px;
            padding: 14px;
            background: #38bdf8;
            color: #000;
            border-radius: 16px;
            margin-top: 24px;
        }
    </style>
</head>
<body>

<h1>‚è± Work Timer</h1>

<div class="block">
    <div class="label">–ú–∏–Ω—É—Ç—ã —Ä–∞–±–æ—Ç—ã</div>
    <div class="value" id="work">25</div>
    <div class="buttons">
        <button class="minus" onclick="change('work', -1)">‚àí</button>
        <button class="plus" onclick="change('work', 1)">+</button>
    </div>
</div>

<div class="block">
    <div class="label">–ú–∏–Ω—É—Ç—ã –ø–µ—Ä–µ—Ä—ã–≤–∞</div>
    <div class="value" id="break">5</div>
    <div class="buttons">
        <button class="minus" onclick="change('break', -1)">‚àí</button>
        <button class="plus" onclick="change('break', 1)">+</button>
    </div>
</div>

<div class="block">
    <div class="label">–í—Å–µ–≥–æ —á–∞—Å–æ–≤</div>
    <div class="value" id="hours">5</div>
    <div class="buttons">
        <button class="minus" onclick="change('hours', -1)">‚àí</button>
        <button class="plus" onclick="change('hours', 1)">+</button>
    </div>
</div>

<div class="block">
    <div class="label">–í—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞</div>
    <div class="value" id="start">10:00</div>
    <div class="buttons">
        <button class="minus" onclick="changeTime(-5)">‚àí</button>
        <button class="plus" onclick="changeTime(5)">+</button>
    </div>
</div>

<button class="start" onclick="startTimer()">‚ñ∂Ô∏è Start</button>

<!-- üî• –ö–†–ò–¢–ò–ß–ù–û: Telegram SDK -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    let state = {
        work: 25,
        break: 5,
        hours: 5,
        startHour: 10,
        startMinute: 0
    };

    function updateUI() {
        document.getElementById("work").innerText = state.work;
        document.getElementById("break").innerText = state.break;
        document.getElementById("hours").innerText = state.hours;
        document.getElementById("start").innerText =
            String(state.startHour).padStart(2, '0') + ':' +
            String(state.startMinute).padStart(2, '0');
    }

    function change(field, delta) {
        state[field] = Math.max(1, state[field] + delta);
        updateUI();
    }

    function changeTime(delta) {
        state.startMinute += delta;

        if (state.startMinute >= 60) {
            state.startMinute -= 60;
            state.startHour = (state.startHour + 1) % 24;
        }

        if (state.startMinute < 0) {
            state.startMinute += 60;
            state.startHour = (state.startHour - 1 + 24) % 24;
        }

        updateUI();
    }

    function startTimer() {
        const payload = {
            work: state.work,
            break: state.break,
            hours: state.hours,
            start:
                String(state.startHour).padStart(2, '0') + ':' +
                String(state.startMinute).padStart(2, '0')
        };

        console.log("SEND:", payload);

        tg.sendData(JSON.stringify(payload));
    }

    updateUI();
</script>

</body>
</html>
